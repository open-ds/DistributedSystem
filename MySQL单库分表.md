# MySQL单库分表

场景：单表每月新增1.5亿条日志。磁盘占满、查询超时。

使用雪花算法生成ID，然后根据ID的前42位时间戳和表明做映射，用此ID作为partition key。但是当查询辅助索引的时候，只有两种方案：使用全局辅助索引，或者使用本地辅助索引。

目前主流的分布式数据库都面临这个问题。

* **本地辅助索引（Locl Secondary Index）** 每个分区维护该分片数据的辅助索引，当查询辅助索引的时候，所有分片同时查询。
* **全局辅助索引（Global Secondary Index）** 只在一个分区维护全局数据的辅助索引，当查询辅助索引的时候，只需要查询一个分片。

我们的场景是日志每月新增1.5亿，日志对应的资源每月只有1200万。

* 按月、季度还是年分表？
* 如何解决辅助索引查询问题？选择全局还是局部

